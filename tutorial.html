

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; BiMMSBM 04/06/2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=27c3e253"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Utility Functions" href="functions/utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BiMMSBM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Functions.html">Functions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-nodes-layer-class">The <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-metadata">Adding Metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exclusive-metadata">Exclusive Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inclusive-metadata">Inclusive Metadata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-metadata-objects-by-name">Accessing Metadata Objects by Name</a></li>
<li class="toctree-l2"><a class="reference internal" href="#binet-class">BiNet Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#binet-class-without-nodes-metadata">BiNet Class Without Nodes Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessing-the-nodes-layer-objects">Accessing the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Objects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-nodes-layer-objects-to-initialize-a-binet-object">Using <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Objects to Initialize a <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-expectation-maximization-em-algorithm">The Expectation Maximization (EM) algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-em-algorithm-and-checking-convergence">Running the EM Algorithm and Checking Convergence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-training-sets-and-test-sets">Using Training Sets and Test Sets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#checking-the-accuracy-and-getting-predictions">Checking the Accuracy and Getting Predictions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#checking-the-accuracy">Checking the Accuracy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#saving-and-loading-the-parameters">Saving and Loading the Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-save-nodes-layer-method">The <code class="docutils literal notranslate"><span class="pre">save_nodes_layer</span></code> Method</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#saving-the-parameters-with-save-mmsbm-parameters-function">Saving the Parameters with <code class="docutils literal notranslate"><span class="pre">save_MMSBM_parameters</span></code> Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-load-binet-from-json-and-the-init-em-from-directory-methods">The <code class="docutils literal notranslate"><span class="pre">load_BiNet_from_json</span></code> and the <code class="docutils literal notranslate"><span class="pre">init_EM_from_directory</span></code> methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plotting-the-membership-matrices">Plotting the Membership Matrices</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BiMMSBM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>This tutorial will guide you through the basic usage of the MMSBM library, showing how to work with nodes, metadata, and the bipartite network structure.</p>
</section>
<section id="the-nodes-layer-class">
<h2>The <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Class<a class="headerlink" href="#the-nodes-layer-class" title="Link to this heading"></a></h2>
<p>The <cite>nodes_layer</cite> class represents one type of nodes that forms the bipartite network. It can represent people, researchers, papers, metabolites, movies… That depends on your dataset.</p>
<p>The best way to initialize a nodes_layer is from a pandas DataFrame:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">jit</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">BiMMSBM</span> <span class="k">as</span> <span class="nn">sbm</span>
<span class="kn">from</span> <span class="nn">BiMMSBM.functions.utils</span> <span class="kn">import</span> <span class="n">save_MMSBM_parameters</span><span class="p">,</span><span class="n">add_codes</span><span class="p">,</span><span class="n">load_EM_parameters</span>

<span class="c1"># Dataframe to use</span>
<span class="n">df_politicians</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;legislator&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Pedro&quot;</span><span class="p">,</span> <span class="s2">&quot;Santiago&quot;</span><span class="p">,</span> <span class="s2">&quot;Alberto&quot;</span><span class="p">,</span> <span class="s2">&quot;Yolanda&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Party&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PSOE&quot;</span><span class="p">,</span> <span class="s2">&quot;VOX&quot;</span><span class="p">,</span> <span class="s2">&quot;PP&quot;</span><span class="p">,</span> <span class="s2">&quot;Sumar&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Movies_preferences&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Action|Drama&quot;</span><span class="p">,</span> <span class="s2">&quot;Belic&quot;</span><span class="p">,</span> <span class="s2">&quot;Belic|Comedy&quot;</span><span class="p">,</span> <span class="s2">&quot;Comedy|Drama&quot;</span><span class="p">]</span>
<span class="p">})</span>

<span class="c1"># Number of groups</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">9</span>
<span class="c1"># You have to tell in which the name of the nodes will be as the second parameter</span>
<span class="n">politicians</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">nodes_layer</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s2">&quot;legislator&quot;</span><span class="p">,</span> <span class="n">df_politicians</span><span class="p">)</span>
</pre></div>
</div>
<p>Once the object is initialized, you can access the dataframe from the <cite>df</cite> attribute, but now it will contain a new column with an integer id that the library will use in the future. The name of the column is the same as the column of the names, but finished in <cite>_id</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">politicians</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>legislator</p></th>
<th class="head"><p>Party</p></th>
<th class="head"><p>Movies_preferences</p></th>
<th class="head"><p>legislator_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>PSOE</p></td>
<td><p>Action|Drama</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>VOX</p></td>
<td><p>Belic</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>PP</p></td>
<td><p>Belic|Comedy</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>Sumar</p></td>
<td><p>Comedy|Drama</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<p>The assignment of the ids with the names of the nodes is in the <cite>dict_codes</cite> attribute and the inverse in the <cite>dict_decodes</cite> attribute. This ids represents the array position that corresponds to each node for the <cite>theta</cite> and <cite>omega</cite> matrices.</p>
<p>You can modify whenever you want the number of groups from the <code class="docutils literal notranslate"><span class="pre">K</span></code> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of groups of politicians: </span><span class="si">{</span><span class="n">politicians</span><span class="o">.</span><span class="n">K</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">politicians</span><span class="o">.</span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of groups of politicians: </span><span class="si">{</span><span class="n">politicians</span><span class="o">.</span><span class="n">K</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Number of groups of politicians: 9</span>
<span class="go">Number of groups of politicians: 2</span>
</pre></div>
</div>
</section>
<section id="adding-metadata">
<h2>Adding Metadata<a class="headerlink" href="#adding-metadata" title="Link to this heading"></a></h2>
<p>When in your dataframe you have extra information about the nodes, you have to tell which columns are metadata and which type of metadata. There are two types of metadata:</p>
<ul class="simple">
<li><p><strong>Exclusive metadata</strong>: These are metadata where each node can only have assigned one attribute. For example the age of a person. A person only has one age, not more than one.</p></li>
<li><p><strong>Inclusive metadata</strong>: These are metadata where each node can have assigned more than one attribute. For example the genre of a movie, one movie can belong to different genres at the same time.</p></li>
</ul>
<section id="exclusive-metadata">
<h3>Exclusive Metadata<a class="headerlink" href="#exclusive-metadata" title="Link to this heading"></a></h3>
<p>Once the <cite>nodes_layer</cite> is initialized, you can add the metadata using the <cite>add_exclusive_metadata</cite> method that will return an <cite>exclusive_metadata</cite> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importance of the metadata</span>
<span class="n">lambda_party</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">parties</span> <span class="o">=</span> <span class="n">politicians</span><span class="o">.</span><span class="n">add_exclusive_metadata</span><span class="p">(</span><span class="n">lambda_party</span><span class="p">,</span> <span class="s2">&quot;Party&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, this object will be stored inside the <cite>nodes_layer</cite> object in the <cite>meta_exclusives</cite> attribute that is a dictionary whose keys are the column names of the metadata and the value the object.</p>
<p>The value of <cite>lambda_party</cite> is how important the metadata will be while the inference procedure is running and it can be accessed from the <cite>lambda_val</cite> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Importance of political parties: </span><span class="si">{</span><span class="n">parties</span><span class="o">.</span><span class="n">lambda_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">parties</span><span class="o">.</span><span class="n">lambda_val</span> <span class="o">=</span> <span class="mf">2.3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Importance of political parties: </span><span class="si">{</span><span class="n">parties</span><span class="o">.</span><span class="n">lambda_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Importance of political parties: 100</span>
<span class="go">Importance of political parties: 2.3</span>
</pre></div>
</div>
<p>When the metadata has been added to the <cite>nodes_layer</cite> object, its dataframe will add a new column with the ids of the metadata with the same column name but finished in <cite>_id</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">politicians</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>legislator</p></th>
<th class="head"><p>Party</p></th>
<th class="head"><p>Movies_preferences</p></th>
<th class="head"><p>legislator_id</p></th>
<th class="head"><p>Party_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>PSOE</p></td>
<td><p>Action|Drama</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>VOX</p></td>
<td><p>Belic</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>PP</p></td>
<td><p>Belic|Comedy</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>Sumar</p></td>
<td><p>Comedy|Drama</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<p>Similarly to the <cite>nodes_layer</cite>, you can access the metadata ids through the <cite>dict_codes</cite> attribute.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">parties</span><span class="o">.</span><span class="n">dict_codes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{&#39;PSOE&#39;: 1, &#39;VOX&#39;: 3, &#39;PP&#39;: 0, &#39;Sumar&#39;: 2}</span>
</pre></div>
</div>
</section>
<section id="inclusive-metadata">
<h3>Inclusive Metadata<a class="headerlink" href="#inclusive-metadata" title="Link to this heading"></a></h3>
<p>Once the <cite>nodes_layer</cite> is initialized, you can add the metadata using the <cite>add_inclusive_metadata</cite> method that will return an <cite>inclusive_metadata</cite> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importance of the metadata</span>
<span class="n">lambda_movies</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="c1"># Number of groups of genres</span>
<span class="n">Tau_movies</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">movies</span> <span class="o">=</span> <span class="n">politicians</span><span class="o">.</span><span class="n">add_inclusive_metadata</span><span class="p">(</span><span class="n">lambda_movies</span><span class="p">,</span> <span class="s2">&quot;Movies_preferences&quot;</span><span class="p">,</span> <span class="n">Tau_movies</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, this object will be stored inside the <cite>nodes_layer</cite> object in the <cite>meta_inclusives</cite> attribute that is a dictionary whose keys are the column names of the metadata and the value the object.</p>
<p>The value of <cite>lambda_movies</cite> is how important the metadata will be while the inference procedure is running and it can be accessed from the <cite>lambda_val</cite> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Importance of politicians movies preferences: </span><span class="si">{</span><span class="n">movies</span><span class="o">.</span><span class="n">lambda_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">lambda_val</span> <span class="o">=</span> <span class="mi">20</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Importance of politicians movies preferences: </span><span class="si">{</span><span class="n">movies</span><span class="o">.</span><span class="n">lambda_val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Importance of politicians movies preferences: 0.3</span>
<span class="go">Importance of politicians movies preferences: 20</span>
</pre></div>
</div>
<p>The value of <cite>Tau_movies</cite> is the number of groups which the metadata will be grouped in the inference and it can be accessed from the <cite>Tau</cite> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of groups of politicians: </span><span class="si">{</span><span class="n">movies</span><span class="o">.</span><span class="n">Tau</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">movies</span><span class="o">.</span><span class="n">Tau</span> <span class="o">=</span> <span class="mi">3</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of groups of politicians: </span><span class="si">{</span><span class="n">movies</span><span class="o">.</span><span class="n">Tau</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Number of groups of politicians: 6</span>
<span class="go">Number of groups of politicians: 3</span>
</pre></div>
</div>
<p>When the metadata has been added to the <cite>nodes_layer</cite> object, its dataframe will add a new column with the ids of the metadata with the same column name but finished in <cite>_id</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">politicians</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>legislator</p></th>
<th class="head"><p>Party</p></th>
<th class="head"><p>Movies_preferences</p></th>
<th class="head"><p>legislator_id</p></th>
<th class="head"><p>Party_id</p></th>
<th class="head"><p>Movies_preferences_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>PSOE</p></td>
<td><p>Action|Drama</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>2|3</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>VOX</p></td>
<td><p>Belic</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>PP</p></td>
<td><p>Belic|Comedy</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0|1</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>Sumar</p></td>
<td><p>Comedy|Drama</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>1|3</p></td>
</tr>
</tbody>
</table>
<p>Similarly to the <cite>nodes_layer</cite>, you can access the metadata ids through the <cite>dict_codes</cite> attribute.</p>
</section>
</section>
<section id="accessing-metadata-objects-by-name">
<h2>Accessing Metadata Objects by Name<a class="headerlink" href="#accessing-metadata-objects-by-name" title="Link to this heading"></a></h2>
<p>You can access the <code class="docutils literal notranslate"><span class="pre">metadata_layer</span></code> objects without using the <code class="docutils literal notranslate"><span class="pre">meta_inclusive</span></code> and <code class="docutils literal notranslate"><span class="pre">meta_exclusives</span></code> dictionaries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">politicians</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">movies</span><span class="p">)]</span> <span class="o">==</span> <span class="n">movies</span>
<span class="n">politicians</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">parties</span><span class="p">)]</span> <span class="o">==</span> <span class="n">parties</span>
</pre></div>
</div>
</section>
<section id="binet-class">
<h2>BiNet Class<a class="headerlink" href="#binet-class" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>The <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> class contains the information about a bipartite network. It contains information about:</dt><dd><ul class="simple">
<li><p>Each of the layers that forms the bipartite network</p></li>
<li><p>The observed links.</p></li>
</ul>
</dd>
</dl>
<section id="binet-class-without-nodes-metadata">
<h3>BiNet Class Without Nodes Metadata<a class="headerlink" href="#binet-class-without-nodes-metadata" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>To declare a <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> object you need, at least, a dataframe with three columns:</dt><dd><ul class="simple">
<li><p>One with the source node</p></li>
<li><p>One with the target node</p></li>
<li><p>The label of the link</p></li>
</ul>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">links_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
    <span class="s2">&quot;target&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">],</span>
    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span><span class="s2">&quot;positive&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span><span class="s2">&quot;negative&quot;</span><span class="p">,</span><span class="s2">&quot;positive&quot;</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">BiNet</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">BiNet</span><span class="p">(</span><span class="n">links_df</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="n">nodes_a_name</span><span class="o">=</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="n">Ka</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodes_b_name</span><span class="o">=</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">Kb</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that you need to specify which columns represent nodes and which is the column of the labels. Also, because the class only distinguishes undirected networks, the columns assignments of <code class="docutils literal notranslate"><span class="pre">nodes_a</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes_b</span></code> are irrelevant. Only the indexing of the matrices of the MMSBM parameters will be affected.</p>
<p>Once the object is initialized, you can access the dataframe from the <code class="docutils literal notranslate"><span class="pre">df</span></code> attribute, but now it will contain three new columns, one for each node type and another for the labels, with an integer id that the library will use in the future. The name of the column is the same as the column of the names, but finished in <code class="docutils literal notranslate"><span class="pre">_id</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">BiNet</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>source</p></th>
<th class="head"><p>target</p></th>
<th class="head"><p>labels</p></th>
<th class="head"><p>labels_id</p></th>
<th class="head"><p>source_id</p></th>
<th class="head"><p>target_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>A</p></td>
<td><p>positive</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>0</p></td>
<td><p>B</p></td>
<td><p>negative</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>C</p></td>
<td><p>positive</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>A</p></td>
<td><p>positive</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>B</p></td>
<td><p>negative</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>C</p></td>
<td><p>positive</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>A</p></td>
<td><p>negative</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>B</p></td>
<td><p>negative</p></td>
<td><p>0</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>C</p></td>
<td><p>positive</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</section>
<section id="accessing-the-nodes-layer-objects">
<h3>Accessing the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Objects<a class="headerlink" href="#accessing-the-nodes-layer-objects" title="Link to this heading"></a></h3>
<p>Two attributes that contain the information of the nodes are the <code class="docutils literal notranslate"><span class="pre">nodes_a</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes_b</span></code> attributes, which are <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_a</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_a</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_b</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_b</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">source &lt;class &#39;BiMMSBM.nodes_layer&#39;&gt;</span>
<span class="go">target &lt;class &#39;BiMMSBM.nodes_layer&#39;&gt;</span>
</pre></div>
</div>
<p>An easier way to access these objects is by using the name of the layer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">BiNet</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">BiNet</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">BiNet</span><span class="o">.</span><span class="n">nodes_b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">True</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As before, you can access a dataframe with the <code class="docutils literal notranslate"><span class="pre">df</span></code> method. Also, it will contain an extra column with the ids.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">BiNet</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>source</p></th>
<th class="head"><p>source_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>target</p></th>
<th class="head"><p>target_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="using-nodes-layer-objects-to-initialize-a-binet-object">
<h2>Using <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> Objects to Initialize a <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> Object<a class="headerlink" href="#using-nodes-layer-objects-to-initialize-a-binet-object" title="Link to this heading"></a></h2>
<p>The previous example only has a link list with labels. Sometimes you want to infer using nodes’ metadata. The best way to do that is by using <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> objects.</p>
<p>First, let’s create the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataframe to use</span>
<span class="n">df_politicians</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;legislator&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Pedro&quot;</span><span class="p">,</span> <span class="s2">&quot;Santiago&quot;</span><span class="p">,</span> <span class="s2">&quot;Alberto&quot;</span><span class="p">,</span> <span class="s2">&quot;Yolanda&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Party&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PSOE&quot;</span><span class="p">,</span> <span class="s2">&quot;VOX&quot;</span><span class="p">,</span> <span class="s2">&quot;PP&quot;</span><span class="p">,</span> <span class="s2">&quot;Sumar&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Movies_preferences&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Action|Drama&quot;</span><span class="p">,</span> <span class="s2">&quot;Belic&quot;</span><span class="p">,</span> <span class="s2">&quot;Belic|Comedy&quot;</span><span class="p">,</span> <span class="s2">&quot;Comedy|Drama&quot;</span><span class="p">]</span>
<span class="p">})</span>
<span class="c1"># Number of groups</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">politicians</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">nodes_layer</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s2">&quot;legislator&quot;</span><span class="p">,</span> <span class="n">df_politicians</span><span class="p">)</span>
<span class="n">politicians</span><span class="o">.</span><span class="n">add_exclusive_metadata</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Party&quot;</span><span class="p">)</span>
<span class="n">politicians</span><span class="o">.</span><span class="n">add_inclusive_metadata</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Movies_preferences&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Dataframe to use</span>
<span class="n">df_bills</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;bill&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Year&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">2021</span><span class="p">,</span> <span class="mi">2022</span><span class="p">]</span>
<span class="p">})</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">bills</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">nodes_layer</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="s2">&quot;bill&quot;</span><span class="p">,</span> <span class="n">df_bills</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can create the <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> object, but with the difference that instead of specifying the name of the nodes layer, you have to use as a parameter the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> object using the <code class="docutils literal notranslate"><span class="pre">nodes_a</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes_b</span></code> parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dataframe to use</span>
<span class="n">df_votes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;legislator&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Pedro&quot;</span><span class="p">,</span><span class="s2">&quot;Pedro&quot;</span><span class="p">,</span><span class="s2">&quot;Pedro&quot;</span><span class="p">,</span><span class="s2">&quot;Santiago&quot;</span><span class="p">,</span><span class="s2">&quot;Santiago&quot;</span><span class="p">,</span><span class="s2">&quot;Santiago&quot;</span><span class="p">,</span>
                   <span class="s2">&quot;Alberto&quot;</span><span class="p">,</span> <span class="s2">&quot;Alberto&quot;</span><span class="p">,</span> <span class="s2">&quot;Alberto&quot;</span><span class="p">,</span> <span class="s2">&quot;Yolanda&quot;</span><span class="p">,</span> <span class="s2">&quot;Yolanda&quot;</span><span class="p">,</span> <span class="s2">&quot;Yolanda&quot;</span><span class="p">],</span>
    <span class="s2">&quot;bill&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>  <span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
             <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>  <span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,],</span>
    <span class="s2">&quot;votes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Yes&quot;</span><span class="p">,</span><span class="s2">&quot;No&quot;</span><span class="p">,</span><span class="s2">&quot;No&quot;</span><span class="p">,</span>  <span class="s2">&quot;No&quot;</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">,</span>
              <span class="s2">&quot;No&quot;</span><span class="p">,</span><span class="s2">&quot;No&quot;</span><span class="p">,</span><span class="s2">&quot;Yes&quot;</span><span class="p">,</span>  <span class="s2">&quot;Yes&quot;</span><span class="p">,</span><span class="s2">&quot;No&quot;</span><span class="p">,</span><span class="s2">&quot;No&quot;</span><span class="p">]</span>
<span class="p">})</span>
<span class="c1"># Creating the BiNet object</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">BiNet</span><span class="p">(</span><span class="n">df_votes</span><span class="p">,</span> <span class="s2">&quot;votes&quot;</span><span class="p">,</span> <span class="n">nodes_a</span><span class="o">=</span><span class="n">bills</span><span class="p">,</span> <span class="n">nodes_b</span><span class="o">=</span><span class="n">politicians</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that you do not need to specify the number of the groups of each <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> because it is contained in the corresponding <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The name of the columns of the layer in both DataFrames (from the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> object and for the <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> object) must coincide. Else, a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> will arise.</p>
</div>
<p>It is not mandatory to use two <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> to create the <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> object when you need metadata from only one of the layers. Remember to specify the number of groups.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example using only one nodes_layer object</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">BiNet</span><span class="p">(</span><span class="n">df_votes</span><span class="p">,</span> <span class="s2">&quot;votes&quot;</span><span class="p">,</span> <span class="n">nodes_a_name</span><span class="o">=</span><span class="s2">&quot;bill&quot;</span><span class="p">,</span> <span class="n">Ka</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nodes_b</span><span class="o">=</span><span class="n">politicians</span><span class="p">)</span>
</pre></div>
</div>
<p>If you display the dataframe of the <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> and the <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> objects, the nodes ids from both layers will coincide.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">votes</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;legislator&quot;</span><span class="p">,</span><span class="s2">&quot;legislator_id&quot;</span><span class="p">,</span><span class="s2">&quot;bill&quot;</span><span class="p">,</span><span class="s2">&quot;bill_id&quot;</span><span class="p">]])</span>
<span class="n">display</span><span class="p">(</span><span class="n">votes</span><span class="p">[</span><span class="s2">&quot;legislator&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;legislator&quot;</span><span class="p">,</span><span class="s2">&quot;legislator_id&quot;</span><span class="p">]])</span>
<span class="n">display</span><span class="p">(</span><span class="n">votes</span><span class="p">[</span><span class="s2">&quot;bill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">df</span><span class="p">[[</span><span class="s2">&quot;bill&quot;</span><span class="p">,</span><span class="s2">&quot;bill_id&quot;</span><span class="p">]])</span>
</pre></div>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>legislator</p></th>
<th class="head"><p>legislator_id</p></th>
<th class="head"><p>bill</p></th>
<th class="head"><p>bill_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>1</p></td>
<td><p>A</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Pedro</p></td>
<td><p>1</p></td>
<td><p>B</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>1</p></td>
<td><p>D</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>2</p></td>
<td><p>A</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>Santiago</p></td>
<td><p>2</p></td>
<td><p>C</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>2</p></td>
<td><p>D</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>0</p></td>
<td><p>A</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Alberto</p></td>
<td><p>0</p></td>
<td><p>B</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>0</p></td>
<td><p>C</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>3</p></td>
<td><p>B</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>Yolanda</p></td>
<td><p>3</p></td>
<td><p>C</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>3</p></td>
<td><p>D</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>legislator</p></th>
<th class="head"><p>legislator_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Pedro</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>Santiago</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-even"><td><p>Alberto</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>Yolanda</p></td>
<td><p>3</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>bill</p></th>
<th class="head"><p>bill_id</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>D</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>C</p></td>
<td><p>2</p></td>
</tr>
</tbody>
</table>
</section>
<section id="the-expectation-maximization-em-algorithm">
<h2>The Expectation Maximization (EM) algorithm<a class="headerlink" href="#the-expectation-maximization-em-algorithm" title="Link to this heading"></a></h2>
<p>To start to infer the parameters of the MMSBM, you have to initialize the parameters. It can be easily done with the <code class="docutils literal notranslate"><span class="pre">init_EM</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="o">.</span><span class="n">init_EM</span><span class="p">()</span>
</pre></div>
</div>
<p>Once the EM has been initialized, the parameters will be stored in attributes. For the membership parameters, each <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> will have a <code class="docutils literal notranslate"><span class="pre">theta</span></code> attribute that is a matrix.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="p">[</span><span class="s2">&quot;legislator&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">array([[0.39067672, 0.60932328],</span>
<span class="go">       [0.51318295, 0.48681705],</span>
<span class="go">       [0.23656348, 0.76343652],</span>
<span class="go">       [0.8699203 , 0.1300797 ]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="p">[</span><span class="s2">&quot;bill&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">theta</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">array([[0.33855864, 0.66144136],</span>
<span class="go">       [0.10264972, 0.89735028],</span>
<span class="go">       [0.33213194, 0.66786806],</span>
<span class="go">       [0.43570408, 0.56429592]])</span>
</pre></div>
</div>
<p>The first index corresponds to the id of the node, the second correspond to the group number.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">BiNet</span></code> object, the probabilities matrix and the expectation parameters will be stored in the <code class="docutils literal notranslate"><span class="pre">pkl</span></code> and <code class="docutils literal notranslate"><span class="pre">omega</span></code> attributes respectivly.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="o">.</span><span class="n">pkl</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">array([[[0.73640347, 0.26359653],</span>
<span class="go">        [0.66204141, 0.33795859]],</span>

<span class="go">       [[0.61438835, 0.38561165],</span>
<span class="go">        [0.7342769 , 0.2657231 ]]])</span>
</pre></div>
</div>
<p>The first and second index corresponds to the groups from <cite>nodes_a</cite> and <cite>nodes_b</cite> respectively. The third correspond to the label id.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="o">.</span><span class="n">omega</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">array([[[[0.14143346, 0.19831325],</span>
<span class="go">        [0.23053494, 0.42971834]],</span>

<span class="go">        [[0.14403937, 0.17518567],</span>
<span class="go">        [0.41166991, 0.26910505]],</span>

<span class="go">        [[0.08461626, 0.24549825],</span>
<span class="go">        [0.13792355, 0.53196193]],</span>

<span class="go">        [[0.        , 0.        ],</span>
<span class="go">        [0.        , 0.        ]]],</span>


<span class="go">      [[[0.04293584, 0.06020319],</span>
<span class="go">        [0.31314921, 0.58371176]],</span>

<span class="go">       [[0.05742163, 0.04897093],</span>
<span class="go">        [0.4188002 , 0.47480724]],</span>

<span class="go">       [[0.        , 0.        ],</span>
<span class="go">        [0.        , 0.        ]],</span>

<span class="go">       [[0.06536891, 0.01253214],</span>
<span class="go">        [0.83596087, 0.08613808]]],</span>


<span class="go">     [[[0.10985576, 0.21967309],</span>
<span class="go">        [0.32315681, 0.34731435]],</span>

<span class="go">      [[0.        , 0.        ],</span>
<span class="go">        [0.        , 0.        ]],</span>

<span class="go">      [[0.0683947 , 0.28299025],</span>
<span class="go">        [0.20119303, 0.44742201]],</span>

<span class="go">      [[0.32134512, 0.04319874],</span>
<span class="go">        [0.53911187, 0.09634426]]],</span>


<span class="go">     [[[0.        , 0.        ],</span>
<span class="go">        [0.        , 0.        ]],</span>

<span class="go">      [[0.24047583, 0.2050852 ],</span>
<span class="go">        [0.2598447 , 0.29459428]],</span>

<span class="go">      [[0.08892354, 0.36793049],</span>
<span class="go">        [0.16847772, 0.37466824]],</span>

<span class="go">      [[0.41526893, 0.05582501],</span>
<span class="go">        [0.44871632, 0.08018974]]]])</span>
</pre></div>
</div>
<p>The first and second index corresponds to the nodes id from <cite>nodes_a</cite> and <cite>nodes_b</cite> respectively. The second and third index corresponds to the groups from <cite>nodes_a</cite> and <cite>nodes_b</cite> respectively.</p>
</section>
<section id="running-the-em-algorithm-and-checking-convergence">
<h2>Running the EM Algorithm and Checking Convergence<a class="headerlink" href="#running-the-em-algorithm-and-checking-convergence" title="Link to this heading"></a></h2>
<p>To run the EM algorithm, you have to use the <code class="docutils literal notranslate"><span class="pre">EM_step</span></code> method. It will make an iteration of the algorithm by default. You can specify the number of iterations with the <code class="docutils literal notranslate"><span class="pre">N_steps</span></code> parameter. To check the convergence, you can use the <code class="docutils literal notranslate"><span class="pre">converges</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N_itt</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">N_check</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of iterations to measure the convergence</span>

<span class="k">for</span> <span class="n">itt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_itt</span><span class="o">//</span><span class="n">N_check</span><span class="p">):</span>
    <span class="n">votes</span><span class="o">.</span><span class="n">EM_step</span><span class="p">(</span><span class="n">N_check</span><span class="p">)</span>
    <span class="n">converges</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">converges</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">itt</span><span class="o">*</span><span class="n">N_check</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">converges</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">converges</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Iteration 0: False</span>
<span class="go">Iteration 5: False</span>
<span class="go">Iteration 10: False</span>
<span class="go">Iteration 15: False</span>
<span class="go">Iteration 20: True</span>
</pre></div>
</div>
<section id="using-training-sets-and-test-sets">
<h3>Using Training Sets and Test Sets<a class="headerlink" href="#using-training-sets-and-test-sets" title="Link to this heading"></a></h3>
<p>You can select a training set instead of using all the links to infer the parameters. You can do that using the <code class="docutils literal notranslate"><span class="pre">training</span></code> parameter when you initialize the EM algorithm.</p>
<p>This parameter can be a list of the links ids that you want to use as a training set, or another dataframe with more links. If not specified, all the links will be used.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Defining the training and test sets</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">votes</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Initializing the EM algorithm with the training set</span>
<span class="n">votes</span><span class="o">.</span><span class="n">init_EM</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="n">df_train</span><span class="p">)</span>

<span class="c1"># Running the EM algorithm</span>
<span class="n">N_itt</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">N_check</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of iterations to measure the convergence</span>
<span class="k">for</span> <span class="n">itt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_itt</span><span class="o">//</span><span class="n">N_check</span><span class="p">):</span>
    <span class="n">votes</span><span class="o">.</span><span class="n">EM_step</span><span class="p">(</span><span class="n">N_check</span><span class="p">)</span>
    <span class="n">converges</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">converges</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">itt</span><span class="o">*</span><span class="n">N_check</span><span class="si">}</span><span class="s2">: converges? </span><span class="si">{</span><span class="n">converges</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">converges</span><span class="p">:</span>
        <span class="k">break</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Iteration 0: converges? False</span>
<span class="go">Iteration 5: converges? False</span>
<span class="go">Iteration 10: converges? False</span>
<span class="go">Iteration 15: converges? False</span>
<span class="go">Iteration 20: converges? False</span>
<span class="go">Iteration 25: converges? False</span>
<span class="go">Iteration 30: converges? False</span>
<span class="go">Iteration 35: converges? False</span>
<span class="go">Iteration 40: converges? False</span>
<span class="go">Iteration 45: converges? True</span>
</pre></div>
</div>
</section>
</section>
<section id="checking-the-accuracy-and-getting-predictions">
<h2>Checking the Accuracy and Getting Predictions<a class="headerlink" href="#checking-the-accuracy-and-getting-predictions" title="Link to this heading"></a></h2>
<p>Once the EM algorithm has converged, you can get the predictions using the <code class="docutils literal notranslate"><span class="pre">get_predicted_labels</span></code> method. You can specify which links you want to infer its labels with the <code class="docutils literal notranslate"><span class="pre">links</span></code> parameter. If no links are specified, it will use the links used for training the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">votes</span><span class="o">.</span><span class="n">get_predicted_labels</span><span class="p">()</span>
<span class="n">votes</span><span class="o">.</span><span class="n">get_predicted_labels</span><span class="p">(</span><span class="n">links</span><span class="o">=</span><span class="n">df_test</span><span class="p">)</span>
</pre></div>
</div>
<section id="checking-the-accuracy">
<h3>Checking the Accuracy<a class="headerlink" href="#checking-the-accuracy" title="Link to this heading"></a></h3>
<p>You can check the accuracy of the predictions using the <code class="docutils literal notranslate"><span class="pre">get_accuracy</span></code> method. By default, it will compute the accuracy of the training set. You can specify the test set with the <code class="docutils literal notranslate"><span class="pre">links</span></code> parameter, by using a list of the links ids or another dataframe with other links.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Accuracy of the training set</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy of the training set: </span><span class="si">{</span><span class="n">votes</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy of the test set: </span><span class="si">{</span><span class="n">votes</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">(</span><span class="n">links</span><span class="o">=</span><span class="n">df_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Accuracy of the training set: 0.8888888888888888</span>
<span class="go">Accuracy of the test set: 0.0</span>
</pre></div>
</div>
</section>
</section>
<section id="saving-and-loading-the-parameters">
<h2>Saving and Loading the Parameters<a class="headerlink" href="#saving-and-loading-the-parameters" title="Link to this heading"></a></h2>
<p>For long runs or for using the parameters later, you can save the parameters. It is very important to notice that it is also important to save the ids of the nodes and labels, and some information of the nodes_layer and BiNet objects before initializing the EM algorithm. To save the parameters you can use the <code class="docutils literal notranslate"><span class="pre">save_nodes_layer</span></code> and <code class="docutils literal notranslate"><span class="pre">save_BiNet</span></code> methods.</p>
<section id="the-save-nodes-layer-method">
<h3>The <code class="docutils literal notranslate"><span class="pre">save_nodes_layer</span></code> Method<a class="headerlink" href="#the-save-nodes-layer-method" title="Link to this heading"></a></h3>
<p>This method is useful when you only want to save the information of a <code class="docutils literal notranslate"><span class="pre">nodes_layer</span></code> object. One example can be when you want to do a 5-fold cross-validation, instead of saving the nodes information for each fold, you can save it once and load it later once for all the folds.</p>
<p>The name of the JSON will be <code class="docutils literal notranslate"><span class="pre">layer_{nodes_layer.name}_data.json</span></code>.</p>
</section>
</section>
<section id="saving-the-parameters-with-save-mmsbm-parameters-function">
<h2>Saving the Parameters with <code class="docutils literal notranslate"><span class="pre">save_MMSBM_parameters</span></code> Function<a class="headerlink" href="#saving-the-parameters-with-save-mmsbm-parameters-function" title="Link to this heading"></a></h2>
<p>To save the parameters of the EM procedure, you can use the <code class="docutils literal notranslate"><span class="pre">save_MMSBM_parameters</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">MMSBM_library.functions.utils</span> <span class="kn">import</span> <span class="n">save_MMSBM_parameters</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;tutorial_saves&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;tutorial_saves/example_BiNet&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="s2">&quot;tutorial_saves/example_parameters&quot;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># Defining the training and test sets</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">votes</span><span class="o">.</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">votes</span><span class="o">.</span><span class="n">save_BiNet</span><span class="p">(</span><span class="s2">&quot;./tutorial_saves/example_BiNet/&quot;</span><span class="p">)</span>

<span class="c1"># Initializing the EM algorithm with the training set</span>
<span class="n">votes</span><span class="o">.</span><span class="n">init_EM</span><span class="p">(</span><span class="n">training</span><span class="o">=</span><span class="n">df_train</span><span class="p">)</span>

<span class="c1"># Running the EM algorithm</span>
<span class="n">N_itt</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">N_check</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Number of iterations to measure the convergence</span>
<span class="k">for</span> <span class="n">itt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N_itt</span><span class="o">//</span><span class="n">N_check</span><span class="p">):</span>
    <span class="n">votes</span><span class="o">.</span><span class="n">EM_step</span><span class="p">(</span><span class="n">N_check</span><span class="p">)</span>
    <span class="n">converges</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">converges</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">itt</span><span class="o">*</span><span class="n">N_check</span><span class="si">}</span><span class="s2">: converges? </span><span class="si">{</span><span class="n">converges</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">converges</span><span class="p">:</span>
        <span class="n">save_MMSBM_parameters</span><span class="p">(</span><span class="n">votes</span><span class="p">,</span> <span class="s2">&quot;./tutorial_saves/example_parameters&quot;</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</div>
<dl class="simple">
<dt>Now different <cite>.npy</cite> files have been created inside <cite>example_parameters</cite> folder:</dt><dd><ul class="simple">
<li><p><cite>theta_a.npy</cite> and <cite>theta_b.npy</cite> contain the parameters of the <cite>nodes_layer</cite> objects that form the <cite>BiNet</cite> object.</p></li>
<li><p><cite>pkl.npy</cite> contains the membership probabilities.</p></li>
<li><p>For each exclusive metadata it will generate:
- <cite>qka_{meta_name}.npy</cite> with the membership probability for each metadata.</p></li>
<li><p>For each inclusive metadata it will generate:
- <cite>q_k_tau_{meta_name}.npy</cite> with the membership probability for each metadata.
- <cite>zeta_{meta_name}.npy</cite> with the membership factors for each metadata.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="the-load-binet-from-json-and-the-init-em-from-directory-methods">
<h2>The <code class="docutils literal notranslate"><span class="pre">load_BiNet_from_json</span></code> and the <code class="docutils literal notranslate"><span class="pre">init_EM_from_directory</span></code> methods<a class="headerlink" href="#the-load-binet-from-json-and-the-init-em-from-directory-methods" title="Link to this heading"></a></h2>
<p>Also, you can load your saved <cite>BiNet</cite> class using the <cite>load_BiNet_from_json</cite> class method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_votes</span> <span class="o">=</span> <span class="n">sbm</span><span class="o">.</span><span class="n">BiNet</span><span class="o">.</span><span class="n">load_BiNet_from_json</span><span class="p">(</span><span class="s2">&quot;./tutorial_saves/example_BiNet/BiNet_data.json&quot;</span><span class="p">,</span>
                                              <span class="n">links</span><span class="o">=</span><span class="n">df_votes</span><span class="p">,</span> <span class="n">links_label</span><span class="o">=</span><span class="s2">&quot;votes&quot;</span><span class="p">,</span>
                                              <span class="n">nodes_a</span><span class="o">=</span><span class="n">bills</span><span class="p">,</span> <span class="n">nodes_b</span><span class="o">=</span><span class="n">politicians</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to load the parameters obtained from an EM procedure to continue the procedure or to analyze the parameters, you have to use the <code class="docutils literal notranslate"><span class="pre">init_EM_from_directory</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_votes</span><span class="o">.</span><span class="n">init_EM_from_directory</span><span class="p">(</span><span class="nb">dir</span><span class="o">=</span><span class="s2">&quot;./tutorial_saves/example_parameters&quot;</span><span class="p">,</span> <span class="n">training</span><span class="o">=</span><span class="n">df_train</span><span class="p">)</span>
</pre></div>
</div>
<p>From here you can continue the EM procedure using the <code class="docutils literal notranslate"><span class="pre">EM_step</span></code> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_votes</span><span class="o">.</span><span class="n">df</span>
<span class="n">loaded_votes</span><span class="o">.</span><span class="n">EM_step</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>Or analyze the parameters and/or links and/or accuracies:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_votes</span><span class="o">.</span><span class="n">df</span>
</pre></div>
</div>
<section id="plotting-the-membership-matrices">
<h3>Plotting the Membership Matrices<a class="headerlink" href="#plotting-the-membership-matrices" title="Link to this heading"></a></h3>
<p>You can visualize the membership matrices of the politicians and the votes using matplotlib:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Plot theta parameters for both nodes as heatmaps</span>
<span class="n">im1</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">loaded_votes</span><span class="o">.</span><span class="n">nodes_a</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">loaded_votes</span><span class="o">.</span><span class="n">nodes_b</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>

<span class="c1"># Add colorbars</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>

<span class="c1"># Set titles</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Legislators Theta Parameters&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Bills Theta Parameters&#39;</span><span class="p">)</span>

<span class="c1"># Label axes</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)</span>

<span class="c1"># Set y-tick labels to node IDs</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">politicians</span><span class="p">)))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">politicians</span><span class="o">.</span><span class="n">dict_decodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">politicians</span><span class="p">))])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bills</span><span class="p">)))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">bills</span><span class="o">.</span><span class="n">dict_decodes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bills</span><span class="p">))])</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">politicians</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">bills</span><span class="o">.</span><span class="n">K</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/theta_parameters.png"><img alt="_images/theta_parameters.png" class="align-center" src="_images/theta_parameters.png" style="width: 800px; height: 350px;" />
</a>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="functions/utils.html" class="btn btn-neutral float-left" title="Utility Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Oscar Fajardo Fontiveros.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>